{"version":3,"sources":["../../../../src/components/Step/index.tsx"],"names":["Wrapper","styled","div","props","ButtonsWrapper","device","mobileL","tablet","StepHeaderWrapper","stepIndex","children","Step","currentStep","stepsLength","nextStep","useContext","errors","mappedFields","useMemo","Array","item","acc","mappedChildrens","child","useState","JSON","lastStepIndex","useEffect","Object","key","values","hasError","setNextButtonDisabled","stepsTitleList","prevStep"],"mappings":"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","sourcesContent":["import React, { FC, useContext, useEffect, useMemo, useState } from 'react'\nimport styled from 'styled-components'\nimport { useFormikContext } from 'formik'\n\nimport Button from '../Button'\nimport StepHeader from './StepHeader'\nimport { FormContext } from '../../utils'\nimport { device } from '../../consts/sizes'\n\nconst Wrapper = styled.div<{ visible: boolean }>`\n  display: ${(props): string => (props.visible ? 'block' : 'none')};\n`\n\ntype ButtonWrapperTypes = { isFirstStep: boolean }\n\n// prettier-ignore\nconst ButtonsWrapper = styled.div<ButtonWrapperTypes>`\n  display: flex;\n  flex-direction: column;\n  \n  & button {\n    flex-grow: 1;\n  }\n\n  @media ${device.mobileL} {\n    flex-direction: row;\n\n    & button {\n      &:first-of-type {\n        margin-right: ${(props: ButtonWrapperTypes): string => props.isFirstStep ? '0px' : '15px'};\n      }\n\n      &:last-child {\n        margin-left: ${(props: ButtonWrapperTypes): string => props.isFirstStep ? '0px' : '15px'};\n      }\n    }\n  }\n\n  @media ${device.tablet} {\n    & button {\n      &:first-of-type {\n        margin-right: ${(props: ButtonWrapperTypes): string => props.isFirstStep ? '0px' : '30px'};\n      }\n\n      &:last-child {\n        margin-left: ${(props: ButtonWrapperTypes): string => props.isFirstStep ? '0px' : '30px'};\n      }\n    }\n  }\n`\n\nconst StepHeaderWrapper = styled.div`\n  display: flex;\n`\n\ntype Props = {\n  stepIndex: number\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  children: any\n}\n\nconst Step: FC<Props> = ({ children, stepIndex }) => {\n  const {\n    currentStep = 0,\n    stepsLength = 1,\n    stepsTitleList,\n    prevStep,\n    nextStep,\n  } = useContext(FormContext)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const { values, errors } = useFormikContext<any>()\n\n  const mappedFields = useMemo(\n    () =>\n      (Array.isArray(children) ? children : [children]).reduce((acc, item) => {\n        if (item.props.name && item.props.required) {\n          acc[item.props.name] = true\n        }\n        if (item.props && item.props.name === 'agreements') {\n          acc[item.props.name] = true\n        }\n        if (item.props.children) {\n          const mappedChildrens = Array.isArray(item.props.children)\n            ? item.props.children\n            : [item.props.children]\n\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          mappedChildrens.forEach((child: any) => {\n            if (child.props.name && child.props.required) {\n              if (item.props.name) {\n                acc[item.props.name][child.props.name] = true\n                return\n              }\n\n              acc[child.props.name] = true\n            }\n          })\n        }\n\n        return acc\n      }, {}),\n    [children]\n  )\n  const [nextButtonDisabled, setNextButtonDisabled] = useState(\n    JSON.stringify(mappedFields) !== JSON.stringify({})\n  )\n  const lastStepIndex = stepsLength ? stepsLength - 1 : 0\n\n  useEffect(() => {\n    let hasError\n\n    Object.keys(mappedFields).some((key: string) => {\n      if (!values[key] || values[key] === '' || errors[key]) {\n        hasError = true\n        return true\n      }\n\n      if (key === 'agreements' && errors[key]) {\n        hasError = true\n        return true\n      }\n\n      return false\n    })\n\n    if (hasError) {\n      setNextButtonDisabled(true)\n    }\n\n    if (!hasError) {\n      setNextButtonDisabled(false)\n    }\n  }, [values, errors, mappedFields])\n\n  return (\n    <Wrapper visible={stepIndex === currentStep}>\n      <StepHeaderWrapper>\n        {currentStep !== 0 && (\n          <StepHeader>\n            {stepsTitleList && stepsTitleList[currentStep - 1]}\n          </StepHeader>\n        )}\n        {stepIndex === currentStep && (\n          <StepHeader activeStep>\n            {stepsTitleList && stepsTitleList[currentStep]}\n          </StepHeader>\n        )}\n        {currentStep === 0 && stepsLength > 1 && (\n          <StepHeader>\n            {stepsTitleList && stepsTitleList[currentStep + 1]}\n          </StepHeader>\n        )}\n      </StepHeaderWrapper>\n      {children}\n      <ButtonsWrapper isFirstStep={currentStep === 0}>\n        {currentStep !== 0 && (\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            text=\"Cofnij\"\n            onClick={prevStep}\n          />\n        )}\n        {currentStep !== lastStepIndex && (\n          <Button\n            disabled={nextButtonDisabled}\n            type=\"button\"\n            text=\"Dalej\"\n            onClick={nextStep}\n          />\n        )}\n        {currentStep === lastStepIndex && (\n          <Button disabled={nextButtonDisabled} type=\"submit\" text=\"WyÅ›lij\" />\n        )}\n      </ButtonsWrapper>\n    </Wrapper>\n  )\n}\n\nexport default Step\n"],"file":"index.js"}
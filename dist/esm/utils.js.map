{"version":3,"sources":["../../src/utils.ts"],"names":["React","FormContext","createContext","setFormValuesToCache","values","formId","window","sessionStorage","setItem","JSON","stringify","getFormValuesFromCache","id","parse","getItem","resetFormValueCache","encodeData","data","Object","keys","map","key","encodeURIComponent","join","sendDataToAwsSQS","queueUrl","fetch","method","headers","body","Action","MessageBody","handleSendDataToApi","apiUrl","fieldsForSkip","dataWithUserAgent","agreements","rest","filteredValues","reduce","acc","includes","mappedAgreements","push","user_agent","navigator","userAgent","Accept","formName","getFieldsValuesFromUrl","paramsList","item","itemValue","URLSearchParams","location","search","get"],"mappings":";;;;AAAA,OAAOA,KAAP,MAA+B,OAA/B;AAGA,OAAO,MAAMC,WAUX,gBAAGD,KAAK,CAACE,aAAN,CAAoB,EAApB,CAVE;AAYP,OAAO,MAAMC,oBAAoB,GAAG,CAClCC,MADkC,EAElCC,MAFkC,KAGzB;AACTA,EAAAA,MAAM,IACJC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA+B,QAAOH,MAAO,EAA7C,EAAgDI,IAAI,CAACC,SAAL,CAAeN,MAAf,CAAhD,CADF;AAED,CANM;AAQP,OAAO,MAAMO,sBAAsB,GACjCC,EADoC,IAGnCA,EAAE,IAAIH,IAAI,CAACI,KAAL,CAAWP,MAAM,CAACC,cAAP,CAAsBO,OAAtB,CAA+B,QAAOF,EAAG,EAAzC,CAAX,CAAP,IACA,EAJK;AAMP,OAAO,MAAMG,mBAAmB,GAAIH,EAAD,IACjCN,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA+B,QAAOI,EAAG,EAAzC,EAA4C,IAA5C,CADK;AAGP,OAAO,MAAMI,UAAwD,GACnEC,IADsE,IAEnE;AACH,SAAOC,MAAM,CAACC,IAAP,CAAYF,IAAZ,EACJG,GADI,CAEFC,GAAD,IACEC,kBAAkB,CAACD,GAAD,CAAlB,GAA0B,GAA1B,GAAgCC,kBAAkB,CAACL,IAAI,CAACI,GAAD,CAAL,CAHjD,EAKJE,IALI,CAKC,GALD,CAAP;AAMD,CATM;AAWP,OAAO,MAAMC,gBAII,GAAG,CAACpB,MAAD,EAASqB,QAAT,KAClBC,KAAK,CACHD,QAAQ,IACN,wEAFC,EAGH;AACEE,EAAAA,MAAM,EAAE,MADV;AAEEC,EAAAA,OAAO,EAAE;AACP,oBAAgB;AADT,GAFX;AAKEC,EAAAA,IAAI,EAAEb,UAAU,CAAC;AACfc,IAAAA,MAAM,EAAE,aADO;AAEfC,IAAAA,WAAW,EAAEtB,IAAI,CAACC,SAAL,CAAeN,MAAf;AAFE,GAAD;AALlB,CAHG,CALA;AAoBP,OAAO,MAAM4B,mBAOI,GAAG,CAClB5B,MADkB,EAElB6B,MAFkB,EAGlB5B,MAHkB,EAIlB6B,aAJkB,EAKlBC,iBALkB,KAMf;AACH,QAAM;AAAEC,IAAAA;AAAF,MAA0BhC,MAAhC;AAAA,QAAuBiC,IAAvB,4BAAgCjC,MAAhC;;AACA,QAAMkC,cAAc,GAAGpB,MAAM,CAACC,IAAP,CAAYkB,IAAZ,EAAkBE,MAAlB,CAAyB,CAACC,GAAD,EAAMnB,GAAN,KAAc;AAC5D,QAAI,CAACa,aAAa,CAACO,QAAd,CAAuBpB,GAAvB,CAAL,EAAkC;AAChCmB,MAAAA,GAAG,CAACnB,GAAD,CAAH,GAAWgB,IAAI,CAAChB,GAAD,CAAf;AACD;;AACD,WAAOmB,GAAP,CAJ4D,CAK5D;AACD,GANsB,EAMpB,EANoB,CAAvB;AAOA,QAAME,gBAAgB,GACpBN,UAAU,IACV;AACAlB,EAAAA,MAAM,CAACC,IAAP,CAAYiB,UAAZ,EAAwBG,MAAxB,CAAoC,CAACC,GAAD,EAAMnB,GAAN,KAAc;AAChD,QAAIA,GAAG,KAAK,WAAR,IAAuBe,UAAU,CAACf,GAAD,CAArC,EAA4C;AAC1CmB,MAAAA,GAAG,CAACG,IAAJ,CAAStB,GAAT;AACD;;AACD,WAAOmB,GAAP;AACD,GALD,EAKG,EALH,CAHF;;AAUA,MAAIL,iBAAJ,EAAuB;AACrB;AACAG,IAAAA,cAAc,CAACM,UAAf,GAA4BtC,MAAM,CAACuC,SAAP,CAAiBC,SAA7C;AACD;;AAED,SAAOpB,KAAK,CAAE,GAAEO,MAAO,UAAS5B,MAAO,OAA3B,EAAmC;AAC7CsB,IAAAA,MAAM,EAAE,MADqC;AAE7CC,IAAAA,OAAO,EAAE;AACPmB,MAAAA,MAAM,EAAE,kBADD;AAEP,sBAAgB;AAFT,KAFoC;AAM7ClB,IAAAA,IAAI,EAAEpB,IAAI,CAACC,SAAL,CAAe;AACnBsC,MAAAA,QAAQ,EAAE3C,MADS;AAEnBY,MAAAA,IAAI,EAAEqB,cAFa;AAGnBF,MAAAA,UAAU,EAAEM;AAHO,KAAf;AANuC,GAAnC,CAAZ;AAYD,CAjDM;AAmDP,OAAO,MAAMO,sBAAsB,GACjCC,UADoC,IAGpCA,UAAU,CAACX,MAAX,CAAkB,CAACC,GAAD,EAAMW,IAAN,KAAe;AAC/B,QAAMC,SAAS,GAAG,IAAIC,eAAJ,CAAoB/C,MAAM,CAACgD,QAAP,CAAgBC,MAApC,EAA4CC,GAA5C,CAAgDL,IAAhD,CAAlB;;AACA,MAAIC,SAAS,KAAK,IAAlB,EAAwB;AACtBZ,IAAAA,GAAG,CAACW,IAAD,CAAH,GAAYC,SAAZ;AACD;;AACD,SAAOZ,GAAP;AACD,CAND,EAMG,EANH,CAHK","sourcesContent":["import React, { Context } from 'react'\nimport { FormValuesType } from './types'\n\nexport const FormContext: Context<{\n  id?: string\n  stepsLength?: number\n  currentStep?: number\n  stepsTitleList?: string[]\n  nextStep?: Function\n  prevStep?: Function\n  apiUrl?: string\n  fieldsForSkip?: string[]\n  addFieldForSkip?: (key: string) => void\n}> = React.createContext({})\n\nexport const setFormValuesToCache = (\n  values: { [key: string]: string | boolean | undefined },\n  formId?: string\n): void => {\n  formId &&\n    window.sessionStorage.setItem(`form-${formId}`, JSON.stringify(values))\n}\n\nexport const getFormValuesFromCache = (\n  id?: string\n): { [key: string]: string | boolean } =>\n  (id && JSON.parse(window.sessionStorage.getItem(`form-${id}`) as string)) ||\n  {}\n\nexport const resetFormValueCache = (id: string): void =>\n  window.sessionStorage.setItem(`form-${id}`, '{}')\n\nexport const encodeData: (data: FormValuesType) => string | undefined = (\n  data\n) => {\n  return Object.keys(data)\n    .map(\n      (key) =>\n        encodeURIComponent(key) + '=' + encodeURIComponent(data[key] as string)\n    )\n    .join('&')\n}\n\nexport const sendDataToAwsSQS: (\n  values: FormValuesType,\n  queueUrl?: string\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n) => Promise<any> = (values, queueUrl) =>\n  fetch(\n    queueUrl ||\n      'https://sqs.eu-central-1.amazonaws.com/031738021372/finelf-users-queue',\n    {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: encodeData({\n        Action: 'SendMessage',\n        MessageBody: JSON.stringify(values),\n      }),\n    }\n  )\n\nexport const handleSendDataToApi: (\n  values: FormValuesType,\n  apiUrl: string,\n  formId: string,\n  fieldsForSkip: string[],\n  dataWithUserAgent?: boolean\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n) => Promise<any> = (\n  values,\n  apiUrl,\n  formId,\n  fieldsForSkip,\n  dataWithUserAgent\n) => {\n  const { agreements, ...rest } = values\n  const filteredValues = Object.keys(rest).reduce((acc, key) => {\n    if (!fieldsForSkip.includes(key)) {\n      acc[key] = rest[key]\n    }\n    return acc\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }, {} as { [key: string]: any })\n  const mappedAgreements =\n    agreements &&\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Object.keys(agreements).reduce<any>((acc, key) => {\n      if (key !== 'selectAll' && agreements[key]) {\n        acc.push(key)\n      }\n      return acc\n    }, [])\n\n  if (dataWithUserAgent) {\n    // eslint-disable-next-line @typescript-eslint/camelcase\n    filteredValues.user_agent = window.navigator.userAgent\n  }\n\n  return fetch(`${apiUrl}/forms/${formId}/data`, {\n    method: 'POST',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      formName: formId,\n      data: filteredValues,\n      agreements: mappedAgreements,\n    }),\n  })\n}\n\nexport const getFieldsValuesFromUrl = (\n  paramsList: string[]\n): { [key: string]: string | null } =>\n  paramsList.reduce((acc, item) => {\n    const itemValue = new URLSearchParams(window.location.search).get(item)\n    if (itemValue !== null) {\n      acc[item] = itemValue\n    }\n    return acc\n  }, {} as { [key: string]: string | null })\n"],"file":"utils.js"}
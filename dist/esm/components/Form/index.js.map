{"version":3,"sources":["../../../../src/components/Form/index.tsx"],"names":["React","useMemo","useState","Formik","Form","styled","ThemeProvider","device","RedirectPage","TransactionId","FormContext","getFormValuesFromCache","resetFormValueCache","handleSendDataToApi","getFieldsValuesFromUrl","formStatuses","StyledForm","props","theme","formBgColor","tablet","FormWrapper","children","onSubmit","customTheme","id","stepsLength","stepsTitles","hasRedirect","redirectUrl","timeToRedirect","redirectHeaderText","logoImg","redirectMainImg","redirectBgImg","sendDataToApi","apiUrl","transactionName","propertyNamesFromUrl","trasationIdValue","URLSearchParams","window","location","search","get","intialValuesFromUrl","length","initialValues","setInitialValues","trasaction_id","currentStep","setCurrentStep","fieldsForSkip","setFieldsForSkip","addFieldForSkip","key","handleSubmit","values","resetForm","setStatus","submited","e","console","log","error","handleReset","prevStep","nextStep","stepsTitleList","status"],"mappings":"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","sourcesContent":["import React, { FC, ReactElement, useMemo, useState } from 'react'\nimport { Formik, Form } from 'formik'\nimport styled from 'styled-components'\n\nimport { ThemeProvider } from '../../consts/theme'\nimport { device } from '../../consts/sizes'\nimport { FormProps, FormValuesType } from '../../types'\nimport RedirectPage from '../RedirectPage'\nimport TransactionId from '../TransactionId'\nimport {\n  FormContext,\n  getFormValuesFromCache,\n  resetFormValueCache,\n  handleSendDataToApi,\n  getFieldsValuesFromUrl,\n} from '../../utils'\nimport { formStatuses } from '../../consts/form'\n\nconst StyledForm = styled(Form)`\n  display: flex;\n  flex-direction: column;\n  max-width: 600px;\n  justify-self: center;\n  margin: 0 10px;\n  background: ${(props): string => props.theme.formBgColor};\n  font-family: 'Manrope', BlinkMacSystemFont, -apple-system, 'Segoe UI',\n    'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans',\n    'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;\n  padding: 20px 15px;\n  border-radius: 6px;\n  box-shadow: 0px 20px 60px rgba(0, 0, 0, 0.08);\n\n  @media ${device.tablet} {\n    padding: 20px 30px;\n    margin: 0 auto;\n  }\n`\n\nconst FormWrapper: FC<FormProps> = ({\n  children,\n  onSubmit,\n  customTheme,\n  id,\n  stepsLength,\n  stepsTitles,\n  hasRedirect,\n  redirectUrl,\n  timeToRedirect,\n  redirectHeaderText,\n  logoImg,\n  redirectMainImg,\n  redirectBgImg,\n  sendDataToApi,\n  apiUrl,\n  transactionName,\n  propertyNamesFromUrl,\n}) => {\n  const trasationIdValue =\n    transactionName &&\n    new URLSearchParams(window.location.search).get(transactionName)\n  const intialValuesFromUrl = useMemo(\n    () =>\n      (propertyNamesFromUrl &&\n        propertyNamesFromUrl.length > 0 &&\n        getFieldsValuesFromUrl(propertyNamesFromUrl)) ||\n      {},\n    [propertyNamesFromUrl]\n  )\n\n  const [initialValues, setInitialValues] = useState({\n    ...intialValuesFromUrl,\n    ...getFormValuesFromCache(id),\n    // eslint-disable-next-line @typescript-eslint/camelcase\n    trasaction_id: trasationIdValue,\n  })\n  const [currentStep, setCurrentStep] = useState(0)\n  const [fieldsForSkip, setFieldsForSkip] = useState<string[]>([])\n\n  const addFieldForSkip = (key: string): void =>\n    setFieldsForSkip([...fieldsForSkip, key])\n\n  const handleSubmit = async (\n    values: FormValuesType,\n    props: {\n      resetForm: () => void\n      setStatus: (status: string) => void\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): Promise<any> => {\n    if (onSubmit) {\n      onSubmit(values, props)\n    }\n\n    try {\n      if (sendDataToApi && apiUrl) {\n        await handleSendDataToApi(values, apiUrl, id, fieldsForSkip)\n      }\n\n      props.resetForm()\n      props.setStatus(formStatuses.submited)\n    } catch (e) {\n      console.log(e)\n      props.setStatus(formStatuses.error)\n    }\n  }\n  const handleReset = (): void => {\n    resetFormValueCache(id)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    setInitialValues({} as any)\n  }\n\n  const prevStep: Function = () => setCurrentStep(currentStep - 1)\n\n  const nextStep: Function = () => setCurrentStep(currentStep + 1)\n\n  return (\n    <FormContext.Provider\n      value={{\n        id,\n        apiUrl,\n        stepsLength,\n        currentStep,\n        stepsTitleList: stepsTitles,\n        nextStep,\n        prevStep,\n        fieldsForSkip,\n        addFieldForSkip,\n      }}\n    >\n      <ThemeProvider customTheme={{ ...customTheme }}>\n        <Formik\n          enableReinitialize\n          initialValues={initialValues}\n          onSubmit={handleSubmit}\n          onReset={handleReset}\n        >\n          {(props): ReactElement =>\n            (hasRedirect && props.status === formStatuses.submited && (\n              <RedirectPage\n                redirectUrl={redirectUrl}\n                backgroundImage={redirectBgImg}\n                logoImg={logoImg}\n                headerText={redirectHeaderText}\n                timeToRedirect={timeToRedirect}\n                mainImg={redirectMainImg}\n              />\n            )) || (\n              <StyledForm id={id}>\n                <TransactionId />\n                {children}\n              </StyledForm>\n            )\n          }\n        </Formik>\n      </ThemeProvider>\n    </FormContext.Provider>\n  )\n}\n\nexport default FormWrapper\n"],"file":"index.js"}
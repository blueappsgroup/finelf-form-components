{"version":3,"sources":["../../../../src/components/Agreements/index.tsx"],"names":["React","useCallback","useContext","useLayoutEffect","useState","styled","CheckboxesGroup","CheckboxField","FormContext","StyledError","StyledErrorText","Agreemnets","linksForReplace","name","requiredErorText","id","apiUrl","agreements","setAgreements","error","setError","replaceLinkInAgreements","replacedAgreements","map","item","newContent","content","Object","keys","forEach","key","replace","fetchAgreements","response","fetch","data","json","e","console","log","length","hasRequired","some","agreement","required","Array","isArray","groupType","defaultProps"],"mappings":"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","sourcesContent":["import React, {\n  useCallback,\n  useContext,\n  useLayoutEffect,\n  useState,\n} from 'react'\nimport styled from 'styled-components'\nimport CheckboxesGroup from '../CheckboxesGroup'\nimport { CheckboxField } from '../'\nimport { FormContext } from '../../utils'\nimport { StyledError } from '../FormInput/base'\ntype AgreementType = {\n  id: string\n  content: string\n  required?: boolean\n}\n\ntype AgreementsPropTypes = {\n  linksForReplace?: { [key: string]: string }\n  name?: string\n  groupType?: string\n  requiredErorText?: string\n}\n\nconst StyledErrorText = styled(StyledError)`\n  position: static;\n`\n\nconst Agreemnets: React.FC<AgreementsPropTypes> = ({\n  linksForReplace,\n  name = 'agreements',\n  requiredErorText = '* Zapoznanie się z treścią regulaminu serwisu oraz polityką prywatności jest wymagane.',\n}) => {\n  const { id, apiUrl } = useContext(FormContext)\n  const [agreements, setAgreements] = useState<AgreementType[]>([])\n  const [error, setError] = useState<boolean>(false)\n  const replaceLinkInAgreements = useCallback(\n    (agreements: AgreementType[]): AgreementType[] => {\n      const replacedAgreements = agreements.map((item) => {\n        let newContent = item.content\n        if (linksForReplace) {\n          Object.keys(linksForReplace).forEach(\n            (key) =>\n              (newContent = newContent.replace(\n                `${key}`,\n                `${linksForReplace[key]}`\n              ))\n          )\n        }\n\n        return { ...item, content: newContent }\n      })\n\n      return replacedAgreements\n    },\n    [linksForReplace]\n  )\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const fetchAgreements = useCallback(async (): Promise<any> => {\n    try {\n      const response = await fetch(`${apiUrl}/forms/${id}/agreements`)\n      const data = await response.json()\n      setAgreements((linksForReplace && replaceLinkInAgreements(data)) || data)\n    } catch (e) {\n      console.log(e)\n    }\n  }, [linksForReplace, apiUrl, replaceLinkInAgreements, id])\n\n  useLayoutEffect(() => {\n    if (agreements.length === 0) {\n      fetchAgreements()\n    }\n\n    if (agreements.length > 0 && !error) {\n      let hasRequired = false\n      agreements.some((agreement) => {\n        if (agreement.required) {\n          hasRequired = true\n          return true\n        }\n\n        return false\n      })\n\n      if (hasRequired !== error) {\n        setError(hasRequired)\n      }\n    }\n  }, [agreements, error, fetchAgreements])\n\n  return (\n    <>\n      {Array.isArray(agreements) && agreements.length > 0 && (\n        <>\n          <CheckboxesGroup name={name}>\n            {agreements.map((item) => (\n              <CheckboxField\n                key={item.id}\n                name={`${item.id}`}\n                HTMLcontent={item.content}\n                required={item.required}\n              />\n            ))}\n          </CheckboxesGroup>\n          {error && <StyledErrorText>{requiredErorText}</StyledErrorText>}\n        </>\n      )}\n    </>\n  )\n}\n\nAgreemnets.defaultProps = {\n  name: 'agreements',\n  groupType: 'checkboxGroup',\n}\n\nexport default Agreemnets\n"],"file":"index.js"}
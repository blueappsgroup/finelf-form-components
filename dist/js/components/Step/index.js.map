{"version":3,"sources":["../../../../src/components/Step/index.tsx"],"names":["Wrapper","styled","div","props","visible","ButtonsWrapper","device","mobileL","isFirstStep","tablet","StepHeaderWrapper","Step","children","stepIndex","onStepComplete","wrapperRef","FormContext","currentStep","stepsLength","stepsTitleList","prevStep","nextStep","values","errors","mappedFields","Array","isArray","reduce","acc","item","name","required","visibleCondition","requiredFields","mappedChildrens","forEach","child","type","JSON","stringify","nextButtonDisabled","setNextButtonDisabled","lastStepIndex","hasError","Object","keys","some","key","handleClick","current","window","scrollTo","offsetTop"],"mappings":"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","sourcesContent":["import React, {\n  FC,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport styled from 'styled-components'\nimport { useFormikContext } from 'formik'\n\nimport Button from '../Button'\nimport StepHeader from './StepHeader'\nimport { FormContext } from '../../utils'\nimport { device } from '../../consts/sizes'\n\nconst Wrapper = styled.div<{ visible: boolean }>`\n  display: ${(props): string => (props.visible ? 'block' : 'none')};\n`\n\ntype ButtonWrapperTypes = { isFirstStep: boolean }\n\n// prettier-ignore\nconst ButtonsWrapper = styled.div<ButtonWrapperTypes>`\n  display: flex;\n  flex-direction: column;\n  \n  & button {\n    flex-grow: 1;\n  }\n\n  @media ${device.mobileL} {\n    flex-direction: row;\n\n    & button {\n      &:first-of-type {\n        margin-right: ${(props: ButtonWrapperTypes): string => props.isFirstStep ? '0px' : '15px'};\n      }\n\n      &:last-child {\n        margin-left: ${(props: ButtonWrapperTypes): string => props.isFirstStep ? '0px' : '15px'};\n      }\n    }\n  }\n\n  @media ${device.tablet} {\n    & button {\n      &:first-of-type {\n        margin-right: ${(props: ButtonWrapperTypes): string => props.isFirstStep ? '0px' : '30px'};\n      }\n\n      &:last-child {\n        margin-left: ${(props: ButtonWrapperTypes): string => props.isFirstStep ? '0px' : '30px'};\n      }\n    }\n  }\n`\n\nconst StepHeaderWrapper = styled.div`\n  display: flex;\n`\n\ntype Props = {\n  stepIndex: number\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  children: any\n  onStepComplete?: () => void\n}\n\nconst Step: FC<Props> = ({ children, stepIndex, onStepComplete }) => {\n  const wrapperRef = useRef<any>(null)\n  const {\n    currentStep = 0,\n    stepsLength = 1,\n    stepsTitleList,\n    prevStep,\n    nextStep,\n  } = useContext(FormContext)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const { values, errors } = useFormikContext<any>()\n\n  const mappedFields = useMemo(\n    () =>\n      (Array.isArray(children) ? children : [children]).reduce(\n        (acc, item) => {\n          if (item.props.name && !item.props.children) {\n            acc[item.props.name] = true\n          }\n          if (\n            item.props.name &&\n            item.props.required &&\n            !item.props.visibleCondition\n          ) {\n            acc.requiredFields[item.props.name] = true\n          }\n          if (item.props && item.props.name === 'agreements') {\n            acc.requiredFields[item.props.name] = true\n          }\n\n          if (item.props.children) {\n            const mappedChildrens = Array.isArray(item.props.children)\n              ? item.props.children\n              : [item.props.children]\n\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            mappedChildrens.forEach((child: any) => {\n              if (\n                child.props.name &&\n                child.props.required &&\n                !child.props.visibleCondition\n              ) {\n                if (item.props.type === 'checkboxGroup') {\n                  !acc.requiredFields[item.props.name] &&\n                    (acc.requiredFields[item.props.name] = {})\n                  acc.requiredFields[item.props.name][child.props.name] = true\n                  return\n                }\n\n                acc.requiredFields[child.props.name] = true\n              }\n              if (child.props.name) {\n                acc[child.props.name] = true\n              }\n            })\n          }\n\n          return acc\n        },\n        { requiredFields: {} }\n      ),\n    [children]\n  )\n\n  const [nextButtonDisabled, setNextButtonDisabled] = useState(\n    JSON.stringify(mappedFields) !== JSON.stringify({})\n  )\n  const lastStepIndex = stepsLength ? stepsLength - 1 : 0\n\n  useEffect(() => {\n    let hasError\n\n    Object.keys(mappedFields.requiredFields).some((key: string) => {\n      if (!values[key] || values[key] === '' || errors[key]) {\n        hasError = true\n        return true\n      }\n\n      if (key === 'agreements' && errors[key]) {\n        hasError = true\n        return true\n      }\n\n      return false\n    })\n\n    if (!hasError) {\n      Object.keys(mappedFields).some((key: string) => {\n        if (errors[key]) {\n          hasError = true\n          return true\n        }\n\n        return false\n      })\n    }\n\n    if (hasError) {\n      setNextButtonDisabled(true)\n    }\n\n    if (!hasError) {\n      setNextButtonDisabled(false)\n    }\n  }, [values, errors, mappedFields, children])\n\n  const handleClick = () => {\n    onStepComplete && onStepComplete()\n    nextStep && nextStep()\n  }\n\n  useEffect(() => {\n    if (stepIndex === currentStep) {\n      wrapperRef.current !== null &&\n        window.scrollTo(0, wrapperRef.current.offsetTop)\n    }\n  }, [currentStep, stepIndex])\n\n  return (\n    <Wrapper ref={wrapperRef} visible={stepIndex === currentStep}>\n      <StepHeaderWrapper>\n        {currentStep !== 0 && (\n          <StepHeader>\n            {stepsTitleList && stepsTitleList[currentStep - 1]}\n          </StepHeader>\n        )}\n        {stepIndex === currentStep && (\n          <StepHeader activeStep>\n            {stepsTitleList && stepsTitleList[currentStep]}\n          </StepHeader>\n        )}\n        {currentStep === 0 && stepsLength > 1 && (\n          <StepHeader>\n            {stepsTitleList && stepsTitleList[currentStep + 1]}\n          </StepHeader>\n        )}\n      </StepHeaderWrapper>\n      {stepIndex === currentStep && children}\n      <ButtonsWrapper isFirstStep={currentStep === 0}>\n        {currentStep !== 0 && (\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            text=\"Cofnij\"\n            onClick={prevStep}\n          />\n        )}\n        {currentStep !== lastStepIndex && (\n          <Button\n            disabled={nextButtonDisabled}\n            type=\"button\"\n            text=\"Dalej\"\n            onClick={handleClick}\n          />\n        )}\n        {currentStep === lastStepIndex && (\n          <Button disabled={nextButtonDisabled} type=\"submit\" text=\"Wyślij\" />\n        )}\n      </ButtonsWrapper>\n    </Wrapper>\n  )\n}\n\nexport default Step\n"],"file":"index.js"}
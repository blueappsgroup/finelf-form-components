{"version":3,"sources":["../../src/utils.ts"],"names":["FormContext","React","createContext","getFormValuesFromCache","id","JSON","parse","window","sessionStorage","getItem","setFormValuesToCache","values","formId","allValues","setItem","stringify","resetFormValueCache","handleSendDataToApi","apiUrl","fieldsForSkip","dataWithUserAgent","agreements","rest","filteredValues","Object","keys","reduce","acc","key","includes","trim","mappedAgreements","push","user_agent","navigator","userAgent","fetch","method","headers","Accept","body","formName","data","getFieldsValuesFromUrl","paramsList","item","itemValue","URLSearchParams","location","search","get"],"mappings":"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","sourcesContent":["import React, { Context } from 'react'\nimport { FormValuesType } from './types'\n\nexport const FormContext: Context<{\n  id?: string\n  stepsLength?: number\n  currentStep?: number\n  stepsTitleList?: string[]\n  nextStep?: Function\n  prevStep?: Function\n  apiUrl?: string\n  fieldsForSkip?: string[]\n  addFieldForSkip?: (key: string) => void\n  errorFromApi?: boolean\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  initialValues?: any\n  handleSubmit?: Function\n  setInitialValues?: Function\n  formStatus?: string\n  setFormStatus?: Function\n}> = React.createContext({})\n\nexport const getFormValuesFromCache = (\n  id?: string\n): { [key: string]: string | boolean } =>\n  (id && JSON.parse(window.sessionStorage.getItem(`form-${id}`) as string)) ||\n  {}\n\nexport const setFormValuesToCache = (\n  values: { [key: string]: string | boolean | undefined },\n  formId?: string\n): void => {\n  const allValues = getFormValuesFromCache(formId)\n  formId &&\n    window.sessionStorage.setItem(\n      `form-${formId}`,\n      JSON.stringify({ ...allValues, ...values })\n    )\n}\n\nexport const resetFormValueCache = (id: string): void =>\n  window.sessionStorage.setItem(`form-${id}`, '{}')\n\nexport const handleSendDataToApi: (\n  values: FormValuesType,\n  apiUrl: string,\n  formId: string,\n  fieldsForSkip: string[],\n  dataWithUserAgent?: boolean\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n) => Promise<any> = (\n  values,\n  apiUrl,\n  formId,\n  fieldsForSkip,\n  dataWithUserAgent\n) => {\n  const { agreements, ...rest } = values\n  const filteredValues = Object.keys(rest).reduce((acc, key) => {\n    if (!fieldsForSkip.includes(key) && rest[key]) {\n      acc[key] = typeof rest[key] === 'string' ? rest[key].trim() : rest[key]\n    }\n    return acc\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }, {} as { [key: string]: any })\n  const mappedAgreements =\n    agreements &&\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Object.keys(agreements).reduce<any>((acc, key) => {\n      if (key !== 'selectAll' && agreements[key]) {\n        acc.push(key)\n      }\n      return acc\n    }, [])\n\n  if (dataWithUserAgent) {\n    // eslint-disable-next-line @typescript-eslint/camelcase\n    filteredValues.user_agent = window.navigator.userAgent\n  }\n\n  return fetch(`${apiUrl}/forms/${formId}/data`, {\n    method: 'POST',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      formName: formId,\n      data: filteredValues,\n      agreements: mappedAgreements,\n    }),\n  })\n}\n\nexport const getFieldsValuesFromUrl = (\n  paramsList: string[]\n): { [key: string]: string | null } =>\n  paramsList.reduce((acc, item) => {\n    const itemValue = new URLSearchParams(window.location.search).get(item)\n    if (itemValue !== null) {\n      acc[item] = itemValue\n    }\n    return acc\n  }, {} as { [key: string]: string | null })\n"],"file":"utils.js"}